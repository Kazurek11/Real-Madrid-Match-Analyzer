

<!DOCTYPE html>
<html class="writer-html5" lang="pl" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RM.RM_players_analyzer &mdash; REAL MADRID MATCH ANALYZER - DOCS 1.0 - dokumentacja</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=331e28ce"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=2827c288"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Indeks" href="../../genindex.html" />
    <link rel="search" title="Szukaj" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            REAL MADRID MATCH ANALYZER - DOCS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Szukaj" aria-label="Szukaj" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">REAL MADRID MATCH ANALYZER - DOCS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Kod modułu</a></li>
      <li class="breadcrumb-item active">RM.RM_players_analyzer</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Kod źródłowy modułu RM.RM_players_analyzer</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">RM_players_analyzer.py - Moduł do analizy danych piłkarzy Realu Madryt.</span>

<span class="sd">Ten skrypt przetwarza dane z plików Excel zawierających statystyki meczowe piłkarzy</span>
<span class="sd">Realu Madryt, wykonuje analizę ich występów, ocen i czasu gry oraz generuje </span>
<span class="sd">podsumowanie w postaci plików CSV.</span>

<span class="sd">Funkcjonalności:</span>
<span class="sd">- Wczytywanie i łączenie danych z wielu plików Excel (sezony 2019-2025)</span>
<span class="sd">- Kategoryzacja meczów na rozgrywki La Liga, Liga Mistrzów i inne</span>
<span class="sd">- Obliczanie czasu gry zawodników w różnych sezonach i rozgrywkach  </span>
<span class="sd">- Analizowanie ocen zawodników przyznawanych przez użytkowników i edytorów</span>
<span class="sd">- Śledzenie informacji o kontuzjach i dostępności zawodników</span>
<span class="sd">- Generowanie profili zawodników z przypisaniem pozycji boiskowych</span>
<span class="sd">- Eksport przetworzonych danych do plików CSV</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">DATE</span> <span class="o">=</span> <span class="s2">&quot;2020-01-01&quot;</span> <span class="c1"># ZACZYNAMY FILTROWANIE SPOTKAŃ OD 2020 ROKU</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Optional</span>

<span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">project_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">current_dir</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">project_root</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">helpers.logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">info</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">debug</span><span class="p">,</span> <span class="n">warning</span><span class="p">,</span> <span class="n">critical</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">helpers.file_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileUtils</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_seq_items&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.width&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.min_rows&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;future.no_silent_downcasting&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>


<div class="viewcode-block" id="RealMadridPlayersAnalyzer">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer">[dokumentacja]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RealMadridPlayersAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Klasa do analizy danych piłkarzy Realu Madryt.</span>
<span class="sd">    </span>
<span class="sd">    Przetwarza dane z plików Excel zawierających statystyki meczowe, generuje </span>
<span class="sd">    kompleksowe profile zawodników z uwzględnieniem występów w różnych rozgrywkach,</span>
<span class="sd">    oblicza czas gry i średnie oceny w poszczególnych sezonach oraz zapisuje </span>
<span class="sd">    wyniki do plików CSV.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        file_utils (FileUtils): Instancja klasy pomocniczej do operacji na plikach</span>
<span class="sd">        project_root (str): Ścieżka do głównego katalogu projektu</span>
<span class="sd">        excel_path_2025 (str): Ścieżka do pliku Excel z ocenami na sezon 2024/2025</span>
<span class="sd">        excel_path_2019_2024 (str): Ścieżka do pliku Excel z ocenami z lat 2019-2024</span>
<span class="sd">        output_dir (str): Ścieżka do katalogu wynikowego</span>
<span class="sd">        df_2025 (pd.DataFrame): DataFrame z danymi z sezonu 2024/2025</span>
<span class="sd">        df_2019v2024 (pd.DataFrame): DataFrame z danymi z sezonów 2019-2024</span>
<span class="sd">        all_data (pd.DataFrame): Połączone dane ze wszystkich sezonów</span>
<span class="sd">        LL_matches (pd.DataFrame): DataFrame z meczami La Liga</span>
<span class="sd">        CL_matches (pd.DataFrame): DataFrame z meczami Ligi Mistrzów</span>
<span class="sd">        other_matches (pd.DataFrame): DataFrame z pozostałymi meczami</span>
<span class="sd">        real_player_csv (pd.DataFrame): DataFrame z profilami zawodników</span>
<span class="sd">        season_names (List[str]): Lista identyfikatorów sezonów</span>
<span class="sd">        injured_players (List[str]): Lista kontuzjowanych zawodników</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inicjalizuje analizator danych piłkarzy Realu Madryt.</span>
<span class="sd">        </span>
<span class="sd">        Metoda inicjalizuje wszystkie wymagane atrybuty, tworzy ścieżki do plików</span>
<span class="sd">        źródłowych i katalogów wynikowych oraz przygotowuje puste DataFrame&#39;y do</span>
<span class="sd">        późniejszego wypełnienia danymi.</span>
<span class="sd">        </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Tworzy katalogu wynikowe jeśli nie istnieją</span>
<span class="sd">            - Definiuje listę sezonów od 20_21 do 24_25</span>
<span class="sd">            - Inicjalizuje listę kontuzjowanych zawodników</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span> <span class="o">=</span> <span class="n">FileUtils</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">get_project_root</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2025</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_root</span><span class="p">,</span> <span class="s2">&quot;Data&quot;</span><span class="p">,</span> <span class="s2">&quot;Excele&quot;</span><span class="p">,</span> <span class="s2">&quot;oceny_pilkarzy2_2025.xlsx&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2019_2024</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_root</span><span class="p">,</span> <span class="s2">&quot;Data&quot;</span><span class="p">,</span> <span class="s2">&quot;Excele&quot;</span><span class="p">,</span> <span class="s2">&quot;real_players_match_19-24.xlsx&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_root</span><span class="p">,</span> <span class="s2">&quot;Data&quot;</span><span class="p">,</span> <span class="s2">&quot;Real&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">ensure_directory_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other_matches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;19_20&quot;</span><span class="p">,</span><span class="s2">&quot;20_21&quot;</span><span class="p">,</span> <span class="s2">&quot;21_22&quot;</span><span class="p">,</span> <span class="s2">&quot;22_23&quot;</span><span class="p">,</span> <span class="s2">&quot;23_24&quot;</span><span class="p">,</span> <span class="s2">&quot;24_25&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">injured_players</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_injured_player</span><span class="p">()</span>
    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.validate_dataframe">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.validate_dataframe">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">required_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sprawdza czy DataFrame ma wymagane kolumny.</span>
<span class="sd">        </span>
<span class="sd">        Metoda weryfikuje czy podany DataFrame zawiera wszystkie kolumny niezbędne </span>
<span class="sd">        do przeprowadzenia analizy. Jeśli brakuje wymaganych kolumn, loguje</span>
<span class="sd">        szczegółowe informacje o braku.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): DataFrame do sprawdzenia</span>
<span class="sd">            required_columns (List[str]): Lista wymaganych kolumn</span>
<span class="sd">            name (str): Nazwa DataFrame (używana w komunikatach logowania)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli wszystkie wymagane kolumny istnieją, False w przeciwnym przypadku</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Sprawdza czy DataFrame nie jest pusty</span>
<span class="sd">            - Identyfikuje i loguje brakujące kolumny</span>
<span class="sd">            - W przypadku błędów używa modułu logger</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> jest pusty!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
            
        <span class="n">missing_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">missing_columns</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brakujące kolumny w </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">missing_columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dostępne kolumny: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.check_file_exists">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.check_file_exists">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sprawdza czy plik istnieje i zwraca informację.</span>
<span class="sd">        </span>
<span class="sd">        Metoda weryfikuje istnienie pliku pod podaną ścieżką i loguje informację</span>
<span class="sd">        o jego dostępności.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            path (str): Ścieżka do pliku</span>
<span class="sd">            description (str): Opis pliku (używany w komunikatach logowania)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli plik istnieje, False w przeciwnym przypadku</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Wynik weryfikacji jest zapisywany do dziennika za pomocą funkcji info()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2"> istnieje: </span><span class="si">{</span><span class="n">exists</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">exists</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.load_excel_files">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.load_excel_files">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_excel_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wczytuje dane z plików Excel.</span>
<span class="sd">        </span>
<span class="sd">        Metoda próbuje wczytać dane z plików Excel zawierających statystyki piłkarzy.</span>
<span class="sd">        Sprawdza dostępność plików i w przypadku ich braku, wyświetla ostrzeżenia.</span>
<span class="sd">        W przypadku problemów ze znalezieniem arkuszy, próbuje znaleźć alternatywne</span>
<span class="sd">        arkusze.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">file_2025_exists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2025</span><span class="p">,</span> <span class="s2">&quot;Plik 2025&quot;</span><span class="p">)</span>
            <span class="n">file_2019_2024_exists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2019_2024</span><span class="p">,</span> <span class="s2">&quot;Plik 2019-2024&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">file_2025_exists</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">file_2019_2024_exists</span><span class="p">:</span>
                <span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Żaden z plików źródłowych nie istnieje. Nie można kontynuować.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            
            <span class="k">if</span> <span class="n">file_2025_exists</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">excel_2025</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2025</span><span class="p">)</span>
                    <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Arkusze w pliku 2025: </span><span class="si">{</span><span class="n">excel_2025</span><span class="o">.</span><span class="n">sheet_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="s2">&quot;pikarze_20250319&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excel_2025</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">:</span>
                        <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Arkusz &#39;pikarze_20250319&#39; nie istnieje w pliku 2025&quot;</span><span class="p">)</span>
                        <span class="n">available_sheets</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">excel_2025</span><span class="o">.</span><span class="n">sheet_names</span> <span class="k">if</span> <span class="s1">&#39;pikarze&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;pilkarze&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
                        <span class="k">if</span> <span class="n">available_sheets</span><span class="p">:</span>
                            <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Próba użycia alternatywnego arkusza: </span><span class="si">{</span><span class="n">available_sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">sheet_name_2025</span> <span class="o">=</span> <span class="n">available_sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sheet_name_2025</span> <span class="o">=</span> <span class="n">excel_2025</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Używam pierwszego dostępnego arkusza: </span><span class="si">{</span><span class="n">sheet_name_2025</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sheet_name_2025</span> <span class="o">=</span> <span class="s2">&quot;pikarze_20250319&quot;</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">load_excel_safe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2025</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name_2025</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;match_date&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
                        <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wczytano dane z 2025, liczba wierszy: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas wczytywania danych 2025: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">file_2019_2024_exists</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">excel_2019_2024</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2019_2024</span><span class="p">)</span>
                    <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Arkusze w pliku 2019-2024: </span><span class="si">{</span><span class="n">excel_2019_2024</span><span class="o">.</span><span class="n">sheet_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="s2">&quot;pilkarze20240528&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excel_2019_2024</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">:</span>
                        <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Arkusz &#39;pilkarze20240528&#39; nie istnieje w pliku 2019-2024&quot;</span><span class="p">)</span>
                        <span class="n">available_sheets</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">excel_2019_2024</span><span class="o">.</span><span class="n">sheet_names</span> <span class="k">if</span> <span class="s1">&#39;pikarze&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;pilkarze&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
                        <span class="k">if</span> <span class="n">available_sheets</span><span class="p">:</span>
                            <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Próba użycia alternatywnego arkusza: </span><span class="si">{</span><span class="n">available_sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">sheet_name_2019_2024</span> <span class="o">=</span> <span class="n">available_sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sheet_name_2019_2024</span> <span class="o">=</span> <span class="n">excel_2019_2024</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Używam pierwszego dostępnego arkusza: </span><span class="si">{</span><span class="n">sheet_name_2019_2024</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sheet_name_2019_2024</span> <span class="o">=</span> <span class="s2">&quot;pilkarze20240528&quot;</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">load_excel_safe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excel_path_2019_2024</span><span class="p">,</span> 
                                                                      <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name_2019_2024</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;match_date&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
                        <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wczytano dane z 2019-2024, liczba wierszy: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas wczytywania danych 2019-2024: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">empty</span><span class="p">):</span>
                <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Nie udało się wczytać żadnych danych.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
                
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas wczytywania plików Excel: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.merge_and_process_data">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.merge_and_process_data">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">merge_and_process_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Łączy i przetwarza dane z różnych plików.</span>
<span class="sd">        </span>
<span class="sd">        Metoda analizuje strukturę wczytanych DataFrame&#39;ów, weryfikuje obecność</span>
<span class="sd">        wymaganych kolumn, łączy dane z różnych źródeł, a następnie dokonuje</span>
<span class="sd">        niezbędnych przekształceń (np. konwersja dat, wypełnianie brakujących wartości).</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Przetworzony DataFrame z danymi o meczach lub pusty DataFrame</span>
<span class="sd">                          w przypadku błędu</span>
<span class="sd">                          </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Sprawdza zgodność struktur DataFrame&#39;ów przed połączeniem</span>
<span class="sd">            - Filtruje dane od poczatyku 2020 roku</span>
<span class="sd">            - Sortuje wyniki według daty meczu</span>
<span class="sd">            - Usuwa niepotrzebne kolumny i wypełnia brakujące wartości</span>
<span class="sd">            - Loguje szczegółowe informacje o procesie i błędach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Kolumny w df_2025:&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Kolumny w df_2019v2024:&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sprawdzamy czy nazwy kolumn się zgadzają&quot;</span><span class="p">)</span>
            
            <span class="n">required_columns</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;match_date&quot;</span><span class="p">,</span> <span class="s2">&quot;home_team&quot;</span><span class="p">,</span> <span class="s2">&quot;away_team&quot;</span><span class="p">,</span> <span class="s2">&quot;home_goals&quot;</span><span class="p">,</span> <span class="s2">&quot;away_goals&quot;</span><span class="p">,</span>
                <span class="s2">&quot;player_name&quot;</span><span class="p">,</span> <span class="s2">&quot;player_min&quot;</span><span class="p">,</span> <span class="s2">&quot;is_first_squad&quot;</span><span class="p">,</span> <span class="s2">&quot;goals&quot;</span><span class="p">,</span> <span class="s2">&quot;assists&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;total_shots&quot;</span><span class="p">,</span> <span class="s2">&quot;shots_on_target&quot;</span><span class="p">,</span> <span class="s2">&quot;user_rating&quot;</span><span class="p">,</span> <span class="s2">&quot;editor_rating&quot;</span>
            <span class="p">]</span>
            
            <span class="n">valid_df_2025</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="p">,</span> <span class="n">required_columns</span><span class="p">,</span> <span class="s2">&quot;df_2025&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="n">valid_df_2019v2024</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="p">,</span> <span class="n">required_columns</span><span class="p">,</span> <span class="s2">&quot;df_2019v2024&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="kc">False</span>
            
            <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Po połączeniu, liczba wierszy w all_data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="s2">&quot;player_description&quot;</span> <span class="ow">in</span> <span class="n">result_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;player_description&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">info</span><span class="p">(</span><span class="s2">&quot;Usunięto kolumnę &#39;player_description&#39;&quot;</span><span class="p">)</span>
                
                <span class="n">result_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Nazwy kolumn w plikach się nie zgadzają. Próba łączenia na wspólnych kolumnach.&quot;</span><span class="p">)</span>
                <span class="n">common_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_columns</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">required_columns</span><span class="p">):</span>
                    <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Próba połączenia na podstawie </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">common_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> wspólnych kolumn&quot;</span><span class="p">)</span>
                    <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="p">[</span><span class="n">common_columns</span><span class="p">],</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="p">[</span><span class="n">common_columns</span><span class="p">]</span>
                    <span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Połączono dane używając </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">common_columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> wspólnych kolumn. Wierszy: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Za mało wspólnych kolumn, aby bezpiecznie połączyć dane&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Używam tylko danych z 2025 (dane 2019-2024 są niedostępne)&quot;</span><span class="p">)</span>
                <span class="n">result_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2025</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Używam tylko danych z 2019-2024 (dane 2025 są niedostępne)&quot;</span><span class="p">)</span>
                <span class="n">result_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_2019v2024</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Brak dostępnych danych - nie można kontynuować analizy&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                
            <span class="k">if</span> <span class="s2">&quot;match_date&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Kolumna &#39;match_date&#39; nie istnieje w danych!&quot;</span><span class="p">)</span>
                <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dostępne kolumny: </span><span class="si">{</span><span class="n">result_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_datetime64_any_dtype</span><span class="p">(</span><span class="n">result_df</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]):</span>
                <span class="n">result_df</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">result_df</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
                <span class="n">invalid_dates</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">invalid_dates</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                    <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Usunięto </span><span class="si">{</span><span class="n">invalid_dates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2"> wierszy z nieprawidłowymi datami&quot;</span><span class="p">)</span>
                    <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="o">~</span><span class="n">invalid_dates</span><span class="p">]</span>
            
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Zakres dat w danych przed filtrowaniem:&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Najwcześniejsza data: </span><span class="si">{</span><span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Najpóźniejsza data: </span><span class="si">{</span><span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Liczba wierszy przed filtrowaniem: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="n">filter_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">DATE</span><span class="p">)</span> <span class="c1"># DATA OD KTOREJ ZACZYNAMY FILTROWANIE </span>
            <span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="n">result_df</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">filter_date</span><span class="p">]</span>
            
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Zakres dat po filtrowaniu:&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Najwcześniejsza data: </span><span class="si">{</span><span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Najpóźniejsza data: </span><span class="si">{</span><span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;match_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Liczba wierszy po filtrowaniu: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="n">result_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;match_date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">result_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;Zwracam DataFrame z danymi o meczach Realu&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result_df</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas łączenia i przetwarzania danych: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.search_injured_player">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.search_injured_player">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">search_injured_player</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pobiera i kategoryzuje aktualnie kontuzjowanych graczy z pliku CSV.</span>
<span class="sd">        </span>
<span class="sd">        Funkcja wczytuje dane z pliku RM_players.csv i filtruje je, aby znaleźć zawodników,</span>
<span class="sd">        którzy są aktualnie w drużynie (actual_player == 1), ale są niedostępni </span>
<span class="sd">        (current_availability == 0) z powodu kontuzji lub innych przyczyn.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            List[str]: Lista nazwisk kontuzjowanych/niedostępnych zawodników.</span>
<span class="sd">            </span>
<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: Gdy plik CSV nie istnieje.</span>
<span class="sd">            ValueError: Gdy dane w pliku CSV mają nieprawidłowy format.</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Używa metody load_csv_safe z klasy FileUtils do bezpiecznego wczytania pliku</span>
<span class="sd">            - Filtruje tylko graczy którzy są w aktualnym składzie (actual_player == 1)</span>
<span class="sd">            - Zwraca tylko tych graczy, którzy są obecnie niedostępni (current_availability == 0)</span>
<span class="sd">            - W przypadku problemów z wczytaniem pliku, FileUtils.load_csv_safe obsłuży błędy</span>
<span class="sd">            - Jeśli plik istnieje ale nie zawiera wymaganych kolumn, zwraca pustą listę</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">get_project_root</span><span class="p">(),</span> <span class="s2">&quot;Data&quot;</span><span class="p">,</span> <span class="s2">&quot;Real&quot;</span><span class="p">,</span> <span class="s2">&quot;RM_players.csv&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">load_csv_safe</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;actual_player&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s2">&quot;current_availability&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;actual_player&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;current_availability&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
                <span class="k">if</span> <span class="s2">&quot;player_name&quot;</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">filtered_data</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
                    
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas wyszukiwania kontuzjowanych graczy: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span></div>

        
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.categorize_teams">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.categorize_teams">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">categorize_teams</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dzieli mecze na kategorie (La Liga, Liga Mistrzów, inne).</span>
<span class="sd">        </span>
<span class="sd">        Metoda kategoryzuje mecze na podstawie nazw drużyn, przypisując je do jednej</span>
<span class="sd">        z trzech kategorii: La Liga, Liga Mistrzów lub inne rozgrywki. Tworzy osobne</span>
<span class="sd">        DataFrame&#39;y dla każdej kategorii i dodaje kolumnę z oznaczeniem typu rozgrywek.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli operacja się powiodła, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Wczytuje listę rywali z La Liga z pliku CSV</span>
<span class="sd">            - Identyfikuje drużyny z Ligi Mistrzów przez wykluczenie</span>
<span class="sd">            - Dodaje kolumnę &#39;competition_category&#39; z oznaczeniem rozgrywek</span>
<span class="sd">            - Loguje liczby meczów w poszczególnych kategoriach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rivals_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_root</span><span class="p">,</span> <span class="s2">&quot;Data&quot;</span><span class="p">,</span> <span class="s2">&quot;Mecze&quot;</span><span class="p">,</span> <span class="s2">&quot;id_nazwa&quot;</span><span class="p">,</span> <span class="s2">&quot;rywale_polskie_nazwy.csv&quot;</span><span class="p">)</span>
            
            <span class="n">rivals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">rivals_path</span><span class="p">)</span>
            <span class="n">rivals_la_liga</span> <span class="o">=</span> <span class="n">rivals</span><span class="p">[</span><span class="s2">&quot;nazwa_rywala&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
            <span class="n">rivals_la_liga</span> <span class="o">=</span> <span class="n">rivals_la_liga</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            
            <span class="n">rivals_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;home_team&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;away_team&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            
            <span class="n">other_teams</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;Real Madryt&#39;</span><span class="p">,</span>
                <span class="s1">&#39;CD Alcoyano&#39;</span><span class="p">,</span>
                <span class="s1">&#39;CD Minera&#39;</span><span class="p">,</span>
                <span class="s1">&#39;CP Cacereño&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Al-Ahly SC&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Al-Hilal SFC&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Arandina CF&#39;</span><span class="p">,</span>
                <span class="s1">&#39;FC Pachuca&#39;</span>
            <span class="p">]</span>
            
            <span class="n">rivalas_CL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rivals_all</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">rivals_la_liga</span><span class="p">))</span>
            <span class="n">rivalas_CL</span> <span class="o">=</span> <span class="p">[</span><span class="n">team</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">rivalas_CL</span> <span class="k">if</span> <span class="n">team</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">other_teams</span><span class="p">]</span>
            
            <span class="n">other_teams</span> <span class="o">=</span> <span class="n">other_teams</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;home_team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rivals_la_liga</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;away_team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rivals_la_liga</span><span class="p">))</span>
            <span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;home_team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rivalas_CL</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;away_team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rivalas_CL</span><span class="p">))</span>
            <span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">other_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span>
                <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">competition_category</span><span class="o">=</span><span class="s2">&quot;Premier Spain Team&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">competition_category</span><span class="o">=</span><span class="s2">&quot;Champions League&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">other_matches</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">competition_category</span><span class="o">=</span><span class="s2">&quot;Other&quot;</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Liczba meczów w La Liga: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Liczba meczów w Lidze Mistrzów: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Liczba meczów w innych rozgrywkach: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">other_matches</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas kategoryzacji drużyn: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

        
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.name_to_id">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.name_to_id">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">name_to_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Funkcja na podstawie nazwiska piłkarza pobiera jego ID z pliku CSV.</span>
<span class="sd">        Args: name (str): Nazwisko piłkarza</span>
<span class="sd">        Returns: bool: True jeśli ID zostało znalezione, False w przeciwnym przypadku</span>

<span class="sd">        Notes:</span>
<span class="sd">            - Używa metody load_csv_safe z klasy FileUtils do bezpiecznego wczytania pliku</span>
<span class="sd">            - Sprawdza czy kolumna &#39;player_name&#39; istnieje w DataFrame</span>
<span class="sd">            - Zwraca ID zawodnika lub False jeśli nie znaleziono</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">get_project_root</span><span class="p">(),</span> <span class="s2">&quot;Data&quot;</span><span class="p">,</span> <span class="s2">&quot;Real&quot;</span><span class="p">,</span> <span class="s2">&quot;RM_players.csv&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_utils</span><span class="o">.</span><span class="n">load_csv_safe</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;player_name&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">player_id</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;player_id&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">player_id</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">player_id</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas wyszukiwania ID zawodnika: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>

        
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.prepare_player_profiles">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.prepare_player_profiles">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_player_profiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tworzy profile zawodników z pozycjami i ID.</span>
<span class="sd">        </span>
<span class="sd">        Metoda tworzy kompleksowe profile zawodników na podstawie unikalnych nazwisk</span>
<span class="sd">        z danych meczowych. Przypisuje każdemu zawodnikowi unikalny identyfikator oraz</span>
<span class="sd">        jedną lub więcej pozycji boiskowych na podstawie predefiniowanych list.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli operacja się powiodła, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Tworzy DataFrame z unikalnymi zawodnikami i przypisuje im ID</span>
<span class="sd">            - Definiuje listy zawodników dla każdej pozycji boiskowej</span>
<span class="sd">            - Jeden zawodnik może mieć przypisanych wiele pozycji</span>
<span class="sd">            - Loguje informacje o liczbie utworzonych profili</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">players_LL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="s2">&quot;player_name&quot;</span><span class="p">:</span> <span class="n">players_LL</span><span class="p">,</span>
                <span class="s2">&quot;player_id&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">players_LL</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">})</span>
            
            <span class="n">player_positions</span> <span class="o">=</span> <span class="p">{}</span>
            
            <span class="n">goalkeepers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Courtois&quot;</span><span class="p">,</span> <span class="s2">&quot;Kepa&quot;</span><span class="p">,</span> <span class="s2">&quot;Yáñez&quot;</span><span class="p">,</span> <span class="s2">&quot;Łunin&quot;</span><span class="p">]</span>
            <span class="n">left_back</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Fran García&quot;</span><span class="p">,</span> <span class="s2">&quot;Mendy&quot;</span><span class="p">,</span> <span class="s2">&quot;Marcelo&quot;</span><span class="p">,</span> <span class="s2">&quot;Miguel Gutiérrez&quot;</span><span class="p">,</span> <span class="s2">&quot;Camavinga&quot;</span><span class="p">]</span>
            <span class="n">right_back</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Carvajal&quot;</span><span class="p">,</span> <span class="s2">&quot;Odriozola&quot;</span><span class="p">,</span> <span class="s2">&quot;Lucas Vázquez&quot;</span><span class="p">,</span> <span class="s2">&quot;Marvin&quot;</span><span class="p">,</span> <span class="s2">&quot;Sergio Santos&quot;</span><span class="p">,</span> <span class="s2">&quot;Nacho&quot;</span><span class="p">]</span>
            <span class="n">center_back</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Lorenzo&quot;</span><span class="p">,</span><span class="s2">&quot;Jacobo Ramón&quot;</span><span class="p">,</span><span class="s2">&quot;Chust&quot;</span><span class="p">,</span><span class="s2">&quot;Asencio&quot;</span><span class="p">,</span> <span class="s2">&quot;Nacho&quot;</span><span class="p">,</span> <span class="s2">&quot;Gila&quot;</span><span class="p">,</span> <span class="s2">&quot;Rüdiger&quot;</span><span class="p">,</span> <span class="s2">&quot;Tchouaméni&quot;</span><span class="p">,</span> <span class="s2">&quot;Alaba&quot;</span><span class="p">,</span> <span class="s2">&quot;Vallejo&quot;</span><span class="p">,</span> <span class="s2">&quot;Varane&quot;</span><span class="p">,</span> <span class="s2">&quot;Ramos&quot;</span><span class="p">,</span> <span class="s2">&quot;Militão&quot;</span><span class="p">]</span>
            <span class="n">def_midfilder</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Chema&quot;</span><span class="p">,</span><span class="s2">&quot;Tchouaméni&quot;</span><span class="p">,</span> <span class="s2">&quot;Kroos&quot;</span><span class="p">,</span> <span class="s2">&quot;Blanco&quot;</span><span class="p">,</span> <span class="s2">&quot;Camavinga&quot;</span><span class="p">,</span> <span class="s2">&quot;Valverde&quot;</span><span class="p">,</span> <span class="s2">&quot;Casemiro&quot;</span><span class="p">]</span>
            <span class="n">midfilder</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Arribas&quot;</span><span class="p">,</span><span class="s2">&quot;Nico Paz&quot;</span><span class="p">,</span><span class="s2">&quot;Mario Martín&quot;</span><span class="p">,</span><span class="s2">&quot;Chema&quot;</span><span class="p">,</span><span class="s2">&quot;Isco&quot;</span><span class="p">,</span> <span class="s2">&quot;Tchouaméni&quot;</span><span class="p">,</span> <span class="s2">&quot;Kroos&quot;</span><span class="p">,</span> <span class="s2">&quot;Blanco&quot;</span><span class="p">,</span> <span class="s2">&quot;Camavinga&quot;</span><span class="p">,</span> <span class="s2">&quot;Valverde&quot;</span><span class="p">,</span> <span class="s2">&quot;Casemiro&quot;</span><span class="p">,</span> <span class="s2">&quot;Modrić&quot;</span><span class="p">,</span> <span class="s2">&quot;Ceballos&quot;</span><span class="p">,</span> <span class="s2">&quot;Bellingham&quot;</span><span class="p">,</span> <span class="s2">&quot;Arda Güler&quot;</span><span class="p">]</span>
            <span class="n">ofensive_midfilder</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Arribas&quot;</span><span class="p">,</span><span class="s2">&quot;Ødegaard&quot;</span><span class="p">,</span><span class="s2">&quot;Isco&quot;</span><span class="p">,</span> <span class="s2">&quot;Bellingham&quot;</span><span class="p">,</span> <span class="s2">&quot;Arda Güler&quot;</span><span class="p">,</span> <span class="s2">&quot;Modrić&quot;</span><span class="p">,</span><span class="s2">&quot;Nico Paz&quot;</span><span class="p">]</span>
            <span class="n">right_winger</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Peter&quot;</span><span class="p">,</span><span class="s2">&quot;Asensio&quot;</span><span class="p">,</span> <span class="s2">&quot;Rodrygo&quot;</span><span class="p">,</span> <span class="s2">&quot;Valverde&quot;</span><span class="p">,</span> <span class="s2">&quot;Arda Güler&quot;</span><span class="p">,</span> <span class="s2">&quot;Brahim&quot;</span><span class="p">,</span> <span class="s2">&quot;Mbappé&quot;</span><span class="p">,</span><span class="s2">&quot;Bale&quot;</span><span class="p">]</span>
            <span class="n">left_winger</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Vinícius&quot;</span><span class="p">,</span> <span class="s2">&quot;Mbappé&quot;</span><span class="p">,</span> <span class="s2">&quot;Hazard&quot;</span><span class="p">,</span> <span class="s2">&quot;Rodrygo&quot;</span><span class="p">]</span>
            <span class="n">striker</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Álvaro&quot;</span><span class="p">,</span><span class="s2">&quot;Mariano&quot;</span><span class="p">,</span><span class="s2">&quot;Endrick&quot;</span><span class="p">,</span> <span class="s2">&quot;Mbappé&quot;</span><span class="p">,</span> <span class="s2">&quot;Borja Mayoral&quot;</span><span class="p">,</span> <span class="s2">&quot;Vinícius&quot;</span><span class="p">,</span> <span class="s2">&quot;Jović&quot;</span><span class="p">,</span> <span class="s2">&quot;Benzema&quot;</span><span class="p">,</span><span class="s2">&quot;Latasa&quot;</span><span class="p">,</span><span class="s2">&quot;Gonzalo&quot;</span><span class="p">,</span><span class="s2">&quot;Hugo Duro&quot;</span><span class="p">,</span><span class="s2">&quot;Joselu&quot;</span><span class="p">]</span>
            
            <span class="k">def</span><span class="w"> </span><span class="nf">add_position</span><span class="p">(</span><span class="n">player_list</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">player_list</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">player</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">player_positions</span><span class="p">:</span>
                        <span class="n">player_positions</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">player_positions</span><span class="p">[</span><span class="n">player</span><span class="p">]:</span>
                        <span class="n">player_positions</span><span class="p">[</span><span class="n">player</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
            
            <span class="n">add_position</span><span class="p">(</span><span class="n">goalkeepers</span><span class="p">,</span> <span class="s2">&quot;GK&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">left_back</span><span class="p">,</span> <span class="s2">&quot;LB&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">right_back</span><span class="p">,</span> <span class="s2">&quot;RB&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">center_back</span><span class="p">,</span> <span class="s2">&quot;CB&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">def_midfilder</span><span class="p">,</span> <span class="s2">&quot;DM&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">midfilder</span><span class="p">,</span> <span class="s2">&quot;CM&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">ofensive_midfilder</span><span class="p">,</span> <span class="s2">&quot;CAM&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">right_winger</span><span class="p">,</span> <span class="s2">&quot;RW&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">left_winger</span><span class="p">,</span> <span class="s2">&quot;LW&quot;</span><span class="p">)</span>
            <span class="n">add_position</span><span class="p">(</span><span class="n">striker</span><span class="p">,</span> <span class="s2">&quot;ST&quot;</span><span class="p">)</span>
            
            <span class="n">positions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">player_positions</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="n">positions_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;player_name&#39;</span><span class="p">,</span> <span class="s1">&#39;player_position&#39;</span><span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;player_position&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">positions_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;player_name&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Utworzono profile dla </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">)</span><span class="si">}</span><span class="s2"> zawodników&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przygotowania profili zawodników: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.create_season_splits">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.create_season_splits">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_season_splits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tworzy podziały danych na sezony dla La Liga i Champions League.</span>
<span class="sd">        </span>
<span class="sd">        Metoda dzieli dane meczowe na poszczególne sezony dla rozgrywek La Liga i Ligi Mistrzów,</span>
<span class="sd">        tworząc słowniki z DataFrame&#39;ami dla każdego sezonu. Filtrowanie odbywa się na podstawie</span>
<span class="sd">        dat rozpoczęcia i zakończenia każdego sezonu.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            Tuple[Dict, Dict]: Słowniki DataFrame&#39;ów dla każdego sezonu (La Liga, Champions League)</span>
<span class="sd">                              lub puste słowniki w przypadku błędu</span>
<span class="sd">                              </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Definiuje dokładne daty granic dla każdego sezonu</span>
<span class="sd">            - Tworzy osobne słowniki dla meczów La Liga i Champions League</span>
<span class="sd">            - Loguje informacje o liczbie meczów w każdym sezonie i rozgrywkach</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">season_LL_dataframes</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;19_20&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2020-09-19&quot;</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;20_21&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2021-05-22&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2020-09-20&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;21_22&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2022-05-20&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2021-08-14&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;22_23&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2023-06-23&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2022-08-14&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;23_24&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2024-05-25&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2023-08-12&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;24_25&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2024-08-18&quot;</span><span class="p">]</span>
            <span class="p">}</span>
            
            <span class="n">season_CL_dataframes</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;19_20&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2021-05-22&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2020-09-20&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;20_21&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2021-05-22&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2020-09-20&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;21_22&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2022-05-28&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2021-08-14&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;22_23&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2023-06-23&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2022-08-14&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;23_24&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="s2">&quot;2024-06-01&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2023-08-12&quot;</span><span class="p">)],</span>
                <span class="s2">&quot;24_25&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">CL_matches</span><span class="p">[</span><span class="s2">&quot;match_date&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;2024-08-18&quot;</span><span class="p">]</span>
            <span class="p">}</span>
            
            <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sezon </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2"> - La Liga: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">season_LL_dataframes</span><span class="p">[</span><span class="n">season</span><span class="p">])</span><span class="si">}</span><span class="s2"> meczów, Champions League: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">season_CL_dataframes</span><span class="p">[</span><span class="n">season</span><span class="p">])</span><span class="si">}</span><span class="s2"> meczów&quot;</span><span class="p">)</span>
                
            <span class="k">return</span> <span class="n">season_LL_dataframes</span><span class="p">,</span> <span class="n">season_CL_dataframes</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas podziału na sezony: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="p">{},</span> <span class="p">{}</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.calculate_playing_time">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.calculate_playing_time">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_playing_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">season_LL_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">season_CL_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Oblicza czas gry dla zawodników w różnych sezonach i rozgrywkach.</span>
<span class="sd">        </span>
<span class="sd">        Metoda sumuje minuty gry dla każdego zawodnika w poszczególnych sezonach</span>
<span class="sd">        i rozgrywkach (La Liga, Champions League) oraz tworzy podsumowanie łącznego</span>
<span class="sd">        czasu gry. Wyniki są zapisywane jako nowe kolumny w DataFrame&#39;ie real_player_csv.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            season_LL_dataframes (Dict): Słownik DataFrame&#39;ów dla sezonów La Liga</span>
<span class="sd">            season_CL_dataframes (Dict): Słownik DataFrame&#39;ów dla sezonów Champions League</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli operacja się powiodła, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Tworzy kolumny z czasem gry dla każdego sezonu i każdej rozgrywki</span>
<span class="sd">            - Sumuje minuty gry dla każdego zawodnika w każdej kategorii</span>
<span class="sd">            - Weryfikuje poprawność obliczeń przez porównanie sum</span>
<span class="sd">            - Zastępuje wartości NaN zerami dla wszystkich kolumn czasu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cl&quot;</span><span class="p">,</span> <span class="s2">&quot;la_liga&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]:</span>
                    <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">comp</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">if</span> <span class="n">col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;all_playing_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="n">season_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">season</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;cl&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;la_liga&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span> <span class="p">{}}</span> <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">}</span>
            
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">season_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">):</span>
                <span class="n">players_in_cl</span> <span class="o">=</span> <span class="n">season_CL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">players_in_cl</span><span class="p">:</span>
                    <span class="n">cl_minutes</span> <span class="o">=</span> <span class="n">season_CL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                        <span class="n">season_CL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> <span class="s2">&quot;player_min&quot;</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="n">season_data</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;cl&quot;</span><span class="p">][</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_minutes</span>
                    <span class="n">season_data</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;all&quot;</span><span class="p">][</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_minutes</span>
                
                <span class="n">players_in_la_liga</span> <span class="o">=</span> <span class="n">season_LL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">players_in_la_liga</span><span class="p">:</span>
                    <span class="n">la_liga_minutes</span> <span class="o">=</span> <span class="n">season_LL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                        <span class="n">season_LL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> <span class="s2">&quot;player_min&quot;</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="n">season_data</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;la_liga&quot;</span><span class="p">][</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="n">la_liga_minutes</span>
                    
                    <span class="k">if</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">season_data</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;all&quot;</span><span class="p">]:</span>
                        <span class="n">season_data</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;all&quot;</span><span class="p">][</span><span class="n">player</span><span class="p">]</span> <span class="o">+=</span> <span class="n">la_liga_minutes</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">season_data</span><span class="p">[</span><span class="n">season_name</span><span class="p">][</span><span class="s2">&quot;all&quot;</span><span class="p">][</span><span class="n">player</span><span class="p">]</span> <span class="o">=</span> <span class="n">la_liga_minutes</span>
            
            <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">player</span><span class="p">,</span> <span class="n">minutes</span> <span class="ow">in</span> <span class="n">season_data</span><span class="p">[</span><span class="n">season</span><span class="p">][</span><span class="s2">&quot;cl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_cl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minutes</span>
                
                <span class="k">for</span> <span class="n">player</span><span class="p">,</span> <span class="n">minutes</span> <span class="ow">in</span> <span class="n">season_data</span><span class="p">[</span><span class="n">season</span><span class="p">][</span><span class="s2">&quot;la_liga&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_la_liga&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minutes</span>
                
                <span class="k">for</span> <span class="n">player</span><span class="p">,</span> <span class="n">minutes</span> <span class="ow">in</span> <span class="n">season_data</span><span class="p">[</span><span class="n">season</span><span class="p">][</span><span class="s2">&quot;all&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minutes</span>
                        <span class="n">current_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;all_playing_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">current_total</span><span class="p">):</span>
                            <span class="n">current_total</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;all_playing_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_total</span> <span class="o">+</span> <span class="n">minutes</span>
            
            <span class="n">time_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;playing_time&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">==</span> <span class="s1">&#39;all_playing_time&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">time_columns</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;Weryfikacja sum czasu gry dla zawodników:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span>
                <span class="n">all_seasons_minutes</span> <span class="o">=</span> <span class="mi">0</span>
                
                <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                    <span class="n">all_minutes_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_all&quot;</span>
                    <span class="k">if</span> <span class="n">all_minutes_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="n">season_minutes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="n">all_minutes_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">season_minutes</span><span class="p">):</span>
                            <span class="n">all_seasons_minutes</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">season_minutes</span><span class="p">)</span>
                
                <span class="n">current_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;all_playing_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">current_all</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">current_all</span> <span class="o">-</span> <span class="n">all_seasons_minutes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Różnica dla </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2">: Suma sezonów: </span><span class="si">{</span><span class="n">all_seasons_minutes</span><span class="si">}</span><span class="s2">, all_playing_time: </span><span class="si">{</span><span class="n">current_all</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s2">&quot;all_playing_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_seasons_minutes</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Podsumowanie czasu gry dla pierwszych 5 zawodników:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">player</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]):</span>
                <span class="n">seasons_played</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">total_minutes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> <span class="s2">&quot;all_playing_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                
                <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                    <span class="n">minutes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> 
                        <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_all&quot;</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">minutes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">seasons_played</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;20</span><span class="si">{</span><span class="n">season</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">/20</span><span class="si">{</span><span class="n">season</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">total_minutes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">total_minutes</span><span class="p">)</span><span class="si">}</span><span class="s2"> minut w sezonach: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seasons_played</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas obliczania czasu gry: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.mark_seasons_played">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.mark_seasons_played">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mark_seasons_played</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Oznacza sezony, w których zawodnik brał udział.</span>
<span class="sd">        </span>
<span class="sd">        Metoda tworzy boolowskie oznaczenia dla każdego sezonu, wskazujące czy</span>
<span class="sd">        dany zawodnik występował w tym sezonie (w którejkolwiek z rozgrywek).</span>
<span class="sd">        Dodatkowo oblicza i zapisuje liczbę sezonów, w których każdy zawodnik grał.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli operacja się powiodła, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Tworzy kolumny typu &#39;season_XX_YY&#39; z wartościami 0/1 dla każdego sezonu</span>
<span class="sd">            - Sumuje liczbę sezonów z aktywnym udziałem zawodnika</span>
<span class="sd">            - Wartość 1 oznacza, że zawodnik grał w danym sezonie w La Liga lub Lidze Mistrzów</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">)):</span>
                <span class="n">column_LL</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">[</span><span class="n">season</span><span class="p">]</span><span class="si">}</span><span class="s2">_la_liga&quot;</span>
                <span class="n">column_CL</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;playing_time_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">[</span><span class="n">season</span><span class="p">]</span><span class="si">}</span><span class="s2">_cl&quot;</span>
                <span class="n">another_column_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;season_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">[</span><span class="n">season</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">another_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">column_LL</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">column_CL</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="mi">1</span><span class="p">,</span>
                    <span class="mi">0</span>
                <span class="p">)</span>
            
            <span class="n">season_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;season_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;seasons_played&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">season_columns</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;Oznaczono sezony, w których zawodnicy brali udział&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas oznaczania sezonów: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.calculate_player_ratings">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.calculate_player_ratings">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_player_ratings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">season_LL_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">season_CL_dataframes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Oblicza średnie oceny zawodników dla różnych sezonów i rozgrywek.</span>
<span class="sd">        </span>
<span class="sd">        Metoda oblicza średnie oceny zawodników (przyznawane przez edytorów i użytkowników)</span>
<span class="sd">        dla każdego sezonu i każdej kategorii rozgrywek. Dodatkowo tworzy łączne</span>
<span class="sd">        podsumowanie ocen dla wszystkich sezonów.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            season_LL_dataframes (Dict): Słownik DataFrame&#39;ów dla sezonów La Liga</span>
<span class="sd">            season_CL_dataframes (Dict): Słownik DataFrame&#39;ów dla sezonów Champions League</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli operacja się powiodła, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Wylicza średnie oceny z pominięciem zerowych wartości</span>
<span class="sd">            - Tworzy osobne kolumny dla ocen edytorów i użytkowników</span>
<span class="sd">            - Rozróżnia między rozgrywkami La Liga i Ligi Mistrzów</span>
<span class="sd">            - Oblicza średnie oceny łącznie dla wszystkich sezonów</span>
<span class="sd">            - Zamienia wartości NaN na 0 dla czytelności</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Inicjalizacja kolumn ocen...&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;la_liga&quot;</span><span class="p">,</span> <span class="s2">&quot;cl&quot;</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">rater</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;editor&quot;</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">]:</span>
                        <span class="n">col_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">rater</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">comp</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas konwersji kolumny </span><span class="si">{</span><span class="n">col_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="n">overall_columns</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;overall_rating_editor_la_liga&quot;</span><span class="p">,</span> <span class="s2">&quot;overall_rating_editor_cl&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;overall_rating_users_la_liga&quot;</span><span class="p">,</span> <span class="s2">&quot;overall_rating_users_cl&quot;</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">overall_columns</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas inicjalizacji kolumny </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Przetwarzanie ocen dla wszystkich sezonów...&quot;</span><span class="p">)</span>
            <span class="n">real_madrid_players</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">season_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">season_ll</span> <span class="o">=</span> <span class="n">season_LL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">]</span>
                    
                    <span class="n">required_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;user_rating&quot;</span><span class="p">,</span> <span class="s2">&quot;editor_rating&quot;</span><span class="p">,</span> <span class="s2">&quot;player_name&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">col</span> <span class="ow">in</span> <span class="n">season_ll</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span><span class="p">):</span>
                        <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">season_ll</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
                        <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brak kolumn </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2"> w danych La Liga dla sezonu </span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">, pomijam...&quot;</span><span class="p">)</span>
                        <span class="k">continue</span>
                        
                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">real_madrid_players</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">player_ll_ratings</span> <span class="o">=</span> <span class="n">season_ll</span><span class="p">[</span>
                                <span class="p">(</span><span class="n">season_ll</span><span class="p">[</span><span class="s2">&quot;user_rating&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> 
                                <span class="p">(</span><span class="n">season_ll</span><span class="p">[</span><span class="s2">&quot;editor_rating&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> 
                                <span class="p">(</span><span class="n">season_ll</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">)</span>
                            <span class="p">]</span>
                            
                            <span class="n">mean_ll_users</span> <span class="o">=</span> <span class="n">player_ll_ratings</span><span class="p">[</span><span class="s2">&quot;user_rating&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                            <span class="n">mean_ll_editor</span> <span class="o">=</span> <span class="n">player_ll_ratings</span><span class="p">[</span><span class="s2">&quot;editor_rating&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                            
                            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span>
                            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">mean_ll_users</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">_users_la_liga&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mean_ll_users</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">mean_ll_editor</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">_editor_la_liga&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mean_ll_editor</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania ocen La Liga dla zawodnika </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2"> w sezonie </span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="n">season_cl</span> <span class="o">=</span> <span class="n">season_CL_dataframes</span><span class="p">[</span><span class="n">season_name</span><span class="p">]</span>
                    
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">col</span> <span class="ow">in</span> <span class="n">season_cl</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span><span class="p">):</span>
                        <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">season_cl</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
                        <span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Brak kolumn </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2"> w danych Champions League dla sezonu </span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">, pomijam...&quot;</span><span class="p">)</span>
                        <span class="k">continue</span>
                        
                    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">real_madrid_players</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">player_cl_ratings</span> <span class="o">=</span> <span class="n">season_cl</span><span class="p">[</span>
                                <span class="p">(</span><span class="n">season_cl</span><span class="p">[</span><span class="s2">&quot;user_rating&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> 
                                <span class="p">(</span><span class="n">season_cl</span><span class="p">[</span><span class="s2">&quot;editor_rating&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> 
                                <span class="p">(</span><span class="n">season_cl</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">)</span>
                            <span class="p">]</span>
                            
                            <span class="n">mean_cl_users</span> <span class="o">=</span> <span class="n">player_cl_ratings</span><span class="p">[</span><span class="s2">&quot;user_rating&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                            <span class="n">mean_cl_editor</span> <span class="o">=</span> <span class="n">player_cl_ratings</span><span class="p">[</span><span class="s2">&quot;editor_rating&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                            
                            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span>
                            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">mean_cl_users</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">_users_cl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mean_cl_users</span><span class="p">)</span>
                            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">mean_cl_editor</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">_editor_cl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mean_cl_editor</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania ocen Champions League dla zawodnika </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2"> w sezonie </span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania sezonu </span><span class="si">{</span><span class="n">season_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Obliczanie ogólnych rankingów...&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">player_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span>
                    
                    <span class="n">editor_la_liga_ratings</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">rating_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_editor_la_liga&quot;</span>
                            <span class="k">if</span> <span class="n">rating_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                                <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="n">rating_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">rating</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="n">editor_la_liga_ratings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania ocen edytorów La Liga dla </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2"> w sezonie </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">editor_la_liga_ratings</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="s2">&quot;overall_rating_editor_la_liga&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">editor_la_liga_ratings</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">editor_la_liga_ratings</span><span class="p">)</span>
                    
                    <span class="n">editor_cl_ratings</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">rating_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_editor_cl&quot;</span>
                            <span class="k">if</span> <span class="n">rating_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                                <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="n">rating_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">rating</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="n">editor_cl_ratings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania ocen edytorów CL dla </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2"> w sezonie </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">editor_cl_ratings</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="s2">&quot;overall_rating_editor_cl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">editor_cl_ratings</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">editor_cl_ratings</span><span class="p">)</span>
                    
                    <span class="n">users_la_liga_ratings</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">rating_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_users_la_liga&quot;</span>
                            <span class="k">if</span> <span class="n">rating_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                                <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="n">rating_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">rating</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="n">users_la_liga_ratings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania ocen użytkowników La Liga dla </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2"> w sezonie </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">users_la_liga_ratings</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="s2">&quot;overall_rating_users_la_liga&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">users_la_liga_ratings</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_la_liga_ratings</span><span class="p">)</span>
                    
                    <span class="n">users_cl_ratings</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">season_names</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">rating_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rating_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">_users_cl&quot;</span>
                            <span class="k">if</span> <span class="n">rating_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                                <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="n">rating_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">rating</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="n">users_cl_ratings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania ocen użytkowników CL dla </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2"> w sezonie </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">users_cl_ratings</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">player_mask</span><span class="p">,</span> <span class="s2">&quot;overall_rating_users_cl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">users_cl_ratings</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_cl_ratings</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas przetwarzania zawodnika </span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Podsumowanie ocen dla pierwszych 3 zawodników:&quot;</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">break</span>
                
                <span class="n">ll_editor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> <span class="s2">&quot;overall_rating_editor_la_liga&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ll_users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> <span class="s2">&quot;overall_rating_users_la_liga&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">cl_editor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> <span class="s2">&quot;overall_rating_editor_cl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">cl_users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player</span><span class="p">,</span> <span class="s2">&quot;overall_rating_users_cl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                
                <span class="k">if</span> <span class="n">ll_editor</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">cl_editor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">player</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
                    <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  La Liga - Edytorzy: </span><span class="si">{</span><span class="n">ll_editor</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Użytkownicy: </span><span class="si">{</span><span class="n">ll_users</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Champions League - Edytorzy: </span><span class="si">{</span><span class="n">cl_editor</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Użytkownicy: </span><span class="si">{</span><span class="n">cl_users</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas obliczania ocen zawodników: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.mark_player_availability">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.mark_player_availability">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mark_player_availability</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Oznacza aktualnych i kontuzjowanych zawodników.</span>
<span class="sd">        </span>
<span class="sd">        Metoda dodaje do profili zawodników informacje o ich aktualnej dostępności</span>
<span class="sd">        i statusie w zespole. Oznacza aktualnych graczy oraz zawodników kontuzjowanych</span>
<span class="sd">        na podstawie predefiniowanej listy.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli operacja się powiodła, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Tworzy kolumnę &#39;acctual_player&#39; oznaczającą czy zawodnik jest aktywny w bieżącym sezonie</span>
<span class="sd">            - Tworzy kolumnę &#39;current_availability&#39; informującą o dostępności zawodnika</span>
<span class="sd">            - Wartość 0 w &#39;current_availability&#39; oznacza kontuzję lub brak w aktualnym składzie</span>
<span class="sd">            - Lista kontuzjowanych zawodników jest zdefiniowana jako atrybut klasy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;acctual_player&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;playing_time_24_25_all&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">1</span><span class="p">,</span>
                <span class="mi">0</span>
            <span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;current_availability&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;current_availability&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;player_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">injured_players</span><span class="p">),</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;current_availability&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;current_availability&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;acctual_player&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="p">[</span><span class="s2">&quot;current_availability&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;Oznaczono aktualnych i kontuzjowanych zawodników&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas oznaczania dostępności zawodników: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.save_results">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.save_results">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zapisuje przetworzone dane do plików CSV.</span>
<span class="sd">        </span>
<span class="sd">        Metoda zapisuje przetworzone dane zawodników do pliku CSV w katalogu</span>
<span class="sd">        wynikowym. Formatuje wartości liczbowe z dwoma miejscami po przecinku.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli operacja się powiodła, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Zapisuje dane do pliku RM_players_stats.csv w katalogu output_dir</span>
<span class="sd">            - Używa formatu float_format=&quot;%.2f&quot; dla czytelności numerów</span>
<span class="sd">            - Pomija indeksy podczas zapisu (index=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;RM_players_stats.csv&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real_player_csv</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zapisano statystyki zawodników do pliku: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Błąd podczas zapisywania wyników: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">False</span></div>

    
<div class="viewcode-block" id="RealMadridPlayersAnalyzer.process_all">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.RealMadridPlayersAnalyzer.process_all">[dokumentacja]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wykonuje cały proces przetwarzania danych.</span>
<span class="sd">        </span>
<span class="sd">        Metoda realizuje kompletny proces analizy danych zawodników, wywołując</span>
<span class="sd">        sekwencyjnie wszystkie niezbędne metody klasy. Jeśli którykolwiek krok</span>
<span class="sd">        zakończy się niepowodzeniem, proces zostaje przerwany.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True jeśli cały proces zakończył się pomyślnie, False w przypadku błędu</span>
<span class="sd">            </span>
<span class="sd">        Notes:</span>
<span class="sd">            - Wykonuje wszystkie kroki analizy w odpowiedniej kolejności</span>
<span class="sd">            - Sprawdza wyniki każdego kroku i przerywa proces w razie błędu</span>
<span class="sd">            - Loguje informacje o rozpoczęciu i zakończeniu całego procesu</span>
<span class="sd">            - Używane metody: load_excel_files, merge_and_process_data, categorize_teams,</span>
<span class="sd">              prepare_player_profiles, create_season_splits, calculate_playing_time,</span>
<span class="sd">              mark_seasons_played, calculate_player_ratings, mark_player_availability, save_results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span><span class="p">(</span><span class="s2">&quot;=== ROZPOCZĘCIE ANALIZY DANYCH PIŁKARZY REALU MADRYT ===&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_excel_files</span><span class="p">():</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Wczytywanie plików Excel nie powiodło się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="n">merged_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_and_process_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">merged_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">merged_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Łączenie i przetwarzanie danych nie powiodło się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span> <span class="o">=</span> <span class="n">merged_data</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">categorize_teams</span><span class="p">():</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Kategoryzacja drużyn nie powiodła się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_player_profiles</span><span class="p">():</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Przygotowanie profili zawodników nie powiodło się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="n">season_LL_dataframes</span><span class="p">,</span> <span class="n">season_CL_dataframes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_season_splits</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">season_LL_dataframes</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">season_CL_dataframes</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Podział na sezony nie powiódł się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_playing_time</span><span class="p">(</span><span class="n">season_LL_dataframes</span><span class="p">,</span> <span class="n">season_CL_dataframes</span><span class="p">):</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Obliczanie czasu gry nie powiodło się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mark_seasons_played</span><span class="p">():</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Oznaczanie sezonów nie powiodło się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_player_ratings</span><span class="p">(</span><span class="n">season_LL_dataframes</span><span class="p">,</span> <span class="n">season_CL_dataframes</span><span class="p">):</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Obliczanie ocen zawodników nie powiodło się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mark_player_availability</span><span class="p">():</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Oznaczanie dostępności zawodników nie powiodło się - przerywam przetwarzanie&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_results</span><span class="p">():</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Zapisywanie wyników nie powiodło się&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="n">info</span><span class="p">(</span><span class="s2">&quot;=== ZAKOŃCZONO ANALIZĘ DANYCH PIŁKARZY REALU MADRYT ===&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>
</div>



<div class="viewcode-block" id="main">
<a class="viewcode-back" href="../../api/RM.html#RM.RM_players_analyzer.main">[dokumentacja]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Główna funkcja uruchamiająca przetwarzanie danych piłkarzy Realu Madryt.</span>
<span class="sd">    </span>
<span class="sd">    Funkcja tworzy instancję klasy RealMadridPlayersAnalyzer i uruchamia proces</span>
<span class="sd">    analizy. Na podstawie wyniku procesu wyświetla odpowiedni komunikat o statusie</span>
<span class="sd">    zakończenia programu.</span>
<span class="sd">    </span>
<span class="sd">    Notes:</span>
<span class="sd">        - Tworzy instancję analizatora</span>
<span class="sd">        - Wywołuje metodę process_all() wykonującą całą analizę</span>
<span class="sd">        - Wyświetla komunikat o powodzeniu lub niepowodzeniu programu</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">analyzer</span> <span class="o">=</span> <span class="n">RealMadridPlayersAnalyzer</span><span class="p">()</span>
        <span class="n">success</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">process_all</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="n">info</span><span class="p">(</span><span class="s2">&quot;Program zakończył pracę pomyślnie.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;Program zakończył pracę z błędami. Sprawdź logi, aby uzyskać więcej informacji.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">critical</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wystąpił nieoczekiwany błąd: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">critical</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
        <span class="k">return</span> <span class="mi">2</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Prawa zastrzeżone 2025, Kacper Figura.</p>
  </div>

  Zbudowano w <a href="https://www.sphinx-doc.org/">Sphinx</a> używając
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    dostarczone przez <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>